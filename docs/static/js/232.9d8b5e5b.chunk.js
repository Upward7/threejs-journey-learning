"use strict";(self.webpackChunkreact_3d=self.webpackChunkreact_3d||[]).push([[232],{4081:(e,t,n)=>{n.d(t,{H:()=>H});var r=n(9435),o=Uint8Array,a=Uint16Array,i=Int32Array,s=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(e,t){for(var n=new a(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new i(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)o[s]=s-n[r]<<5|r;return{b:n,r:o}},f=u(s,2),h=f.b,d=f.r;h[28]=258,d[258]=28;for(var p=u(l,0),w=p.b,y=(p.r,new a(32768)),v=0;v<32768;++v){var g=(43690&v)>>1|(21845&v)<<1;g=(61680&(g=(52428&g)>>2|(13107&g)<<2))>>4|(3855&g)<<4,y[v]=((65280&g)>>8|(255&g)<<8)>>1}var m=function(e,t,n){for(var r=e.length,o=0,i=new a(t);o<r;++o)e[o]&&++i[e[o]-1];var s,l=new a(t);for(o=1;o<t;++o)l[o]=l[o-1]+i[o-1]<<1;if(n){s=new a(1<<t);var c=15-t;for(o=0;o<r;++o)if(e[o])for(var u=o<<4|e[o],f=t-e[o],h=l[e[o]-1]++<<f,d=h|(1<<f)-1;h<=d;++h)s[y[h]>>c]=u}else for(s=new a(r),o=0;o<r;++o)e[o]&&(s[o]=y[l[e[o]-1]++]>>15-e[o]);return s},b=new o(288);for(v=0;v<144;++v)b[v]=8;for(v=144;v<256;++v)b[v]=9;for(v=256;v<280;++v)b[v]=7;for(v=280;v<288;++v)b[v]=8;var E=new o(32);for(v=0;v<32;++v)E[v]=5;var A=m(b,9,1),S=m(E,5,1),M=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},U=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},R=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},C=function(e){return(e+7)/8|0},k=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new o(e.subarray(t,n))},x=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],O=function(e,t,n){var r=new Error(t||x[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,O),!n)throw r;return r},I=function(e,t,n,r){var a=e.length,i=r?r.length:0;if(!a||t.f&&!t.l)return n||new o(0);var u=!n,f=u||2!=t.i,d=t.i;u&&(n=new o(3*a));var p=function(e){var t=n.length;if(e>t){var r=new o(Math.max(2*t,e));r.set(n),n=r}},y=t.f||0,v=t.p||0,g=t.b||0,b=t.l,E=t.d,x=t.m,I=t.n,P=8*a;do{if(!b){y=U(e,v,1);var L=U(e,v+1,3);if(v+=3,!L){var N=e[(X=C(v)+4)-4]|e[X-3]<<8,z=X+N;if(z>a){d&&O(0);break}f&&p(g+N),n.set(e.subarray(X,z),g),t.b=g+=N,t.p=v=8*z,t.f=y;continue}if(1==L)b=A,E=S,x=9,I=5;else if(2==L){var H=U(e,v,31)+257,_=U(e,v+10,15)+4,T=H+U(e,v+5,31)+1;v+=14;for(var D=new o(T),B=new o(19),F=0;F<_;++F)B[c[F]]=U(e,v+3*F,7);v+=3*_;var G=M(B),V=(1<<G)-1,W=m(B,G,1);for(F=0;F<T;){var X,Y=W[U(e,v,V)];if(v+=15&Y,(X=Y>>4)<16)D[F++]=X;else{var Z=0,q=0;for(16==X?(q=3+U(e,v,3),v+=2,Z=D[F-1]):17==X?(q=3+U(e,v,7),v+=3):18==X&&(q=11+U(e,v,127),v+=7);q--;)D[F++]=Z}}var Q=D.subarray(0,H),$=D.subarray(H);x=M(Q),I=M($),b=m(Q,x,1),E=m($,I,1)}else O(1);if(v>P){d&&O(0);break}}f&&p(g+131072);for(var j=(1<<x)-1,J=(1<<I)-1,K=v;;K=v){var ee=(Z=b[R(e,v)&j])>>4;if((v+=15&Z)>P){d&&O(0);break}if(Z||O(2),ee<256)n[g++]=ee;else{if(256==ee){K=v,b=null;break}var te=ee-254;if(ee>264){var ne=s[F=ee-257];te=U(e,v,(1<<ne)-1)+h[F],v+=ne}var re=E[R(e,v)&J],oe=re>>4;re||O(3),v+=15&re;$=w[oe];if(oe>3){ne=l[oe];$+=R(e,v)&(1<<ne)-1,v+=ne}if(v>P){d&&O(0);break}f&&p(g+131072);var ae=g+te;if(g<$){var ie=i-$,se=Math.min($,ae);for(ie+g<0&&O(3);g<se;++g)n[g]=r[ie+g]}for(;g<ae;++g)n[g]=n[g-$]}}t.l=b,t.p=K,t.b=g,t.f=y,b&&(y=1,t.m=x,t.d=E,t.n=I)}while(!y);return g!=n.length&&u?k(n,0,g):n.subarray(0,g)},P=new o(0),L=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&O(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&O(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function N(e,t){return I(e.subarray(L(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var z="undefined"!=typeof TextDecoder&&new TextDecoder;try{z.decode(P,{stream:!0})}catch(_){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;class H extends r.BRH{constructor(e){super(e),this.type=r.ix0}parse(e){const t=65536,n=14,o=65537,a=16384,i=Math.pow(2.7182818,2.2);const s={l:0,c:0,lc:0};function l(e,t,n,r,o){for(;n<e;)t=t<<8|V(r,o),n+=8;n-=e,s.l=t>>n&(1<<e)-1,s.c=t,s.lc=n}const c=new Array(59);function u(e,t,n,r,a,i){const u=t;let f=0,h=0;for(;r<=a;r++){if(u.value-t.value>n)return!1;l(6,f,h,e,u);const o=s.l;if(f=s.c,h=s.lc,i[r]=o,63==o){if(u.value-t.value>n)throw new Error("Something wrong with hufUnpackEncTable");l(8,f,h,e,u);let o=s.l+6;if(f=s.c,h=s.lc,r+o>a+1)throw new Error("Something wrong with hufUnpackEncTable");for(;o--;)i[r++]=0;r--}else if(o>=59){let e=o-59+2;if(r+e>a+1)throw new Error("Something wrong with hufUnpackEncTable");for(;e--;)i[r++]=0;r--}}!function(e){for(let n=0;n<=58;++n)c[n]=0;for(let n=0;n<o;++n)c[e[n]]+=1;let t=0;for(let n=58;n>0;--n){const e=t+c[n]>>1;c[n]=t,t=e}for(let n=0;n<o;++n){const t=e[n];t>0&&(e[n]=t|c[t]++<<6)}}(i)}function f(e){return 63&e}function h(e){return e>>6}const d={c:0,lc:0};function p(e,t,n,r){e=e<<8|V(n,r),t+=8,d.c=e,d.lc=t}const w={c:0,lc:0};function y(e,t,n,r,o,a,i,s,l){if(e==t){r<8&&(p(n,r,o,a),n=d.c,r=d.lc);let e=n>>(r-=8);if(e=new Uint8Array([e])[0],s.value+e>l)return!1;const t=i[s.value-1];for(;e-- >0;)i[s.value++]=t}else{if(!(s.value<l))return!1;i[s.value++]=e}w.c=n,w.lc=r}function v(e){return 65535&e}function g(e){const t=v(e);return t>32767?t-65536:t}const m={a:0,b:0};function b(e,t){const n=g(e),r=g(t),o=n+(1&r)+(r>>1),a=o,i=o-r;m.a=a,m.b=i}function E(e,t){const n=v(e),r=v(t),o=n-(r>>1)&65535,a=r+o-32768&65535;m.a=a,m.b=o}function A(e,t,n,r,o,a,i){const s=i<16384,l=n>o?o:n;let c,u,f=1;for(;f<=l;)f<<=1;for(f>>=1,c=f,f>>=1;f>=1;){u=0;const i=u+a*(o-c),l=a*f,h=a*c,d=r*f,p=r*c;let w,y,v,g;for(;u<=i;u+=h){let o=u;const a=u+r*(n-c);for(;o<=a;o+=p){const n=o+d,r=o+l,a=r+d;s?(b(e[o+t],e[r+t]),w=m.a,v=m.b,b(e[n+t],e[a+t]),y=m.a,g=m.b,b(w,y),e[o+t]=m.a,e[n+t]=m.b,b(v,g),e[r+t]=m.a,e[a+t]=m.b):(E(e[o+t],e[r+t]),w=m.a,v=m.b,E(e[n+t],e[a+t]),y=m.a,g=m.b,E(w,y),e[o+t]=m.a,e[n+t]=m.b,E(v,g),e[r+t]=m.a,e[a+t]=m.b)}if(n&f){const n=o+l;s?b(e[o+t],e[n+t]):E(e[o+t],e[n+t]),w=m.a,e[n+t]=m.b,e[o+t]=w}}if(o&f){let o=u;const a=u+r*(n-c);for(;o<=a;o+=p){const n=o+d;s?b(e[o+t],e[n+t]):E(e[o+t],e[n+t]),w=m.a,e[n+t]=m.b,e[o+t]=w}}c=f,f>>=1}return u}function S(e,t,r,i,s,l){const c=r.value,v=G(t,r),g=G(t,r);r.value+=4;const m=G(t,r);if(r.value+=4,v<0||v>=o||g<0||g>=o)throw new Error("Something wrong with HUF_ENCSIZE");const b=new Array(o),E=new Array(a);!function(e){for(let t=0;t<a;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(E);if(u(e,r,i-(r.value-c),v,g,b),m>8*(i-(r.value-c)))throw new Error("Something wrong with hufUncompress");!function(e,t,r,o){for(;t<=r;t++){const r=h(e[t]),a=f(e[t]);if(r>>a)throw new Error("Invalid table entry");if(a>n){const e=o[r>>a-n];if(e.len)throw new Error("Invalid table entry");if(e.lit++,e.p){const t=e.p;e.p=new Array(e.lit);for(let n=0;n<e.lit-1;++n)e.p[n]=t[n]}else e.p=new Array(1);e.p[e.lit-1]=t}else if(a){let e=0;for(let i=1<<n-a;i>0;i--){const i=o[(r<<n-a)+e];if(i.len||i.p)throw new Error("Invalid table entry");i.len=a,i.lit=t,e++}}}}(b,v,g,E),function(e,t,r,o,a,i,s,l,c){let u=0,v=0;const g=s,m=Math.trunc(o.value+(a+7)/8);for(;o.value<m;)for(p(u,v,r,o),u=d.c,v=d.lc;v>=n;){const a=t[u>>v-n&16383];if(a.len)v-=a.len,y(a.lit,i,u,v,r,o,l,c,g),u=w.c,v=w.lc;else{if(!a.p)throw new Error("hufDecode issues");let t;for(t=0;t<a.lit;t++){const n=f(e[a.p[t]]);for(;v<n&&o.value<m;)p(u,v,r,o),u=d.c,v=d.lc;if(v>=n&&h(e[a.p[t]])==(u>>v-n&(1<<n)-1)){v-=n,y(a.p[t],i,u,v,r,o,l,c,g),u=w.c,v=w.lc;break}}if(t==a.lit)throw new Error("hufDecode issues")}}const b=8-a&7;for(u>>=b,v-=b;v>0;){const e=t[u<<n-v&16383];if(!e.len)throw new Error("hufDecode issues");v-=e.len,y(e.lit,i,u,v,r,o,l,c,g),u=w.c,v=w.lc}}(b,E,e,r,m,g,l,s,{value:0})}function M(e){for(let t=1;t<e.length;t++){const n=e[t-1]+e[t]-128;e[t]=n}}function U(e,t){let n=0,r=Math.floor((e.length+1)/2),o=0;const a=e.length-1;for(;!(o>a)&&(t[o++]=e[n++],!(o>a));)t[o++]=e[r++]}function R(e){let t=e.byteLength;const n=new Array;let r=0;const o=new DataView(e);for(;t>0;){const e=o.getInt8(r++);if(e<0){const a=-e;t-=a+1;for(let e=0;e<a;e++)n.push(o.getUint8(r++))}else{const a=e;t-=2;const i=o.getUint8(r++);for(let e=0;e<a+1;e++)n.push(i)}}return n}function C(e,t,n){let r,o=1;for(;o<64;)r=t[e.value],65280==r?o=64:r>>8==255?o+=255&r:(n[o]=r,o++),e.value++}function k(e,t){t[0]=q(e[0]),t[1]=q(e[1]),t[2]=q(e[5]),t[3]=q(e[6]),t[4]=q(e[14]),t[5]=q(e[15]),t[6]=q(e[27]),t[7]=q(e[28]),t[8]=q(e[2]),t[9]=q(e[4]),t[10]=q(e[7]),t[11]=q(e[13]),t[12]=q(e[16]),t[13]=q(e[26]),t[14]=q(e[29]),t[15]=q(e[42]),t[16]=q(e[3]),t[17]=q(e[8]),t[18]=q(e[12]),t[19]=q(e[17]),t[20]=q(e[25]),t[21]=q(e[30]),t[22]=q(e[41]),t[23]=q(e[43]),t[24]=q(e[9]),t[25]=q(e[11]),t[26]=q(e[18]),t[27]=q(e[24]),t[28]=q(e[31]),t[29]=q(e[40]),t[30]=q(e[44]),t[31]=q(e[53]),t[32]=q(e[10]),t[33]=q(e[19]),t[34]=q(e[23]),t[35]=q(e[32]),t[36]=q(e[39]),t[37]=q(e[45]),t[38]=q(e[52]),t[39]=q(e[54]),t[40]=q(e[20]),t[41]=q(e[22]),t[42]=q(e[33]),t[43]=q(e[38]),t[44]=q(e[46]),t[45]=q(e[51]),t[46]=q(e[55]),t[47]=q(e[60]),t[48]=q(e[21]),t[49]=q(e[34]),t[50]=q(e[37]),t[51]=q(e[47]),t[52]=q(e[50]),t[53]=q(e[56]),t[54]=q(e[59]),t[55]=q(e[61]),t[56]=q(e[35]),t[57]=q(e[36]),t[58]=q(e[48]),t[59]=q(e[49]),t[60]=q(e[57]),t[61]=q(e[58]),t[62]=q(e[62]),t[63]=q(e[63])}function x(e){const t=.5*Math.cos(.7853975),n=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),o=.5*Math.cos(3*3.14159/16),a=.5*Math.cos(.981746875),i=.5*Math.cos(3*3.14159/8),s=.5*Math.cos(1.374445625),l=new Array(4),c=new Array(4),u=new Array(4),f=new Array(4);for(let h=0;h<8;++h){const d=8*h;l[0]=r*e[d+2],l[1]=i*e[d+2],l[2]=r*e[d+6],l[3]=i*e[d+6],c[0]=n*e[d+1]+o*e[d+3]+a*e[d+5]+s*e[d+7],c[1]=o*e[d+1]-s*e[d+3]-n*e[d+5]-a*e[d+7],c[2]=a*e[d+1]-n*e[d+3]+s*e[d+5]+o*e[d+7],c[3]=s*e[d+1]-a*e[d+3]+o*e[d+5]-n*e[d+7],u[0]=t*(e[d+0]+e[d+4]),u[3]=t*(e[d+0]-e[d+4]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],f[0]=u[0]+u[1],f[1]=u[3]+u[2],f[2]=u[3]-u[2],f[3]=u[0]-u[1],e[d+0]=f[0]+c[0],e[d+1]=f[1]+c[1],e[d+2]=f[2]+c[2],e[d+3]=f[3]+c[3],e[d+4]=f[3]-c[3],e[d+5]=f[2]-c[2],e[d+6]=f[1]-c[1],e[d+7]=f[0]-c[0]}for(let h=0;h<8;++h)l[0]=r*e[16+h],l[1]=i*e[16+h],l[2]=r*e[48+h],l[3]=i*e[48+h],c[0]=n*e[8+h]+o*e[24+h]+a*e[40+h]+s*e[56+h],c[1]=o*e[8+h]-s*e[24+h]-n*e[40+h]-a*e[56+h],c[2]=a*e[8+h]-n*e[24+h]+s*e[40+h]+o*e[56+h],c[3]=s*e[8+h]-a*e[24+h]+o*e[40+h]-n*e[56+h],u[0]=t*(e[h]+e[32+h]),u[3]=t*(e[h]-e[32+h]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],f[0]=u[0]+u[1],f[1]=u[3]+u[2],f[2]=u[3]-u[2],f[3]=u[0]-u[1],e[0+h]=f[0]+c[0],e[8+h]=f[1]+c[1],e[16+h]=f[2]+c[2],e[24+h]=f[3]+c[3],e[32+h]=f[3]-c[3],e[40+h]=f[2]-c[2],e[48+h]=f[1]-c[1],e[56+h]=f[0]-c[0]}function O(e){for(let t=0;t<64;++t){const n=e[0][t],r=e[1][t],o=e[2][t];e[0][t]=n+1.5747*o,e[1][t]=n-.1873*r-.4682*o,e[2][t]=n+1.8556*r}}function I(e,t,n){for(let o=0;o<64;++o)t[n+o]=r.GxU.toHalfFloat(P(e[o]))}function P(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(i,Math.abs(e)-1)}function L(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function z(e){const t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),n=new Uint8Array(R(t)),r=new Uint8Array(n.length);return M(n),U(n,r),new DataView(r.buffer)}function H(e){const t=N(e.array.slice(e.offset.value,e.offset.value+e.size)),n=new Uint8Array(t.length);return M(t),U(t,n),new DataView(n.buffer)}function _(e){const n=e.viewer,r={value:e.offset.value},o=new Uint16Array(e.columns*e.lines*(e.inputChannels.length*e.type)),a=new Uint8Array(8192);let i=0;const s=new Array(e.inputChannels.length);for(let t=0,w=e.inputChannels.length;t<w;t++)s[t]={},s[t].start=i,s[t].end=s[t].start,s[t].nx=e.columns,s[t].ny=e.lines,s[t].size=e.type,i+=s[t].nx*s[t].ny*s[t].size;const l=Q(n,r),c=Q(n,r);if(c>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(l<=c)for(let t=0;t<c-l+1;t++)a[t+l]=W(n,r);const u=new Uint16Array(t),f=function(e,n){let r=0;for(let a=0;a<t;++a)(0==a||e[a>>3]&1<<(7&a))&&(n[r++]=a);const o=r-1;for(;r<t;)n[r++]=0;return o}(a,u),h=G(n,r);S(e.array,n,r,h,o,i);for(let t=0;t<e.inputChannels.length;++t){const e=s[t];for(let n=0;n<s[t].size;++n)A(o,e.start+n,e.nx,e.size,e.ny,e.nx*e.size,f)}!function(e,t,n){for(let r=0;r<n;++r)t[r]=e[t[r]]}(u,o,i);let d=0;const p=new Uint8Array(o.buffer.byteLength);for(let t=0;t<e.lines;t++)for(let n=0;n<e.inputChannels.length;n++){const e=s[n],t=e.nx*e.size,r=new Uint8Array(o.buffer,2*e.end,2*t);p.set(r,d),d+=2*t,e.end+=t}return new DataView(p.buffer)}function T(e){const t=N(e.array.slice(e.offset.value,e.offset.value+e.size)),n=e.inputChannels.length*e.lines*e.columns*e.totalBytes,r=new ArrayBuffer(n),o=new DataView(r);let a=0,i=0;const s=new Array(4);for(let l=0;l<e.lines;l++)for(let n=0;n<e.inputChannels.length;n++){let r=0;switch(e.inputChannels[n].pixelType){case 1:s[0]=a,s[1]=s[0]+e.columns,a=s[1]+e.columns;for(let n=0;n<e.columns;++n){r+=t[s[0]++]<<8|t[s[1]++],o.setUint16(i,r,!0),i+=2}break;case 2:s[0]=a,s[1]=s[0]+e.columns,s[2]=s[1]+e.columns,a=s[2]+e.columns;for(let n=0;n<e.columns;++n){r+=t[s[0]++]<<24|t[s[1]++]<<16|t[s[2]++]<<8,o.setUint32(i,r,!0),i+=4}}}return o}function D(e){const t=e.viewer,n={value:e.offset.value},r=new Uint8Array(e.columns*e.lines*(e.inputChannels.length*e.type*2)),o={version:X(t,n),unknownUncompressedSize:X(t,n),unknownCompressedSize:X(t,n),acCompressedSize:X(t,n),dcCompressedSize:X(t,n),rleCompressedSize:X(t,n),rleUncompressedSize:X(t,n),rleRawSize:X(t,n),totalAcUncompressedCount:X(t,n),totalDcUncompressedCount:X(t,n),acCompression:X(t,n)};if(o.version<2)throw new Error("EXRLoader.parse: "+ae.compression+" version "+o.version+" is unsupported");const a=new Array;let i=Q(t,n)-2;for(;i>0;){const e=B(t.buffer,n),r=W(t,n),o=r>>2&3,s=new Int8Array([(r>>4)-1])[0],l=W(t,n);a.push({name:e,index:s,type:l,compression:o}),i-=e.length+3}const s=ae.channels,l=new Array(e.inputChannels.length);for(let w=0;w<e.inputChannels.length;++w){const t=l[w]={},n=s[w];t.name=n.name,t.compression=0,t.decoded=!1,t.type=n.pixelType,t.pLinear=n.pLinear,t.width=e.columns,t.height=e.lines}const c={idx:new Array(3)};for(let w=0;w<e.inputChannels.length;++w){const e=l[w];for(let t=0;t<a.length;++t){const n=a[t];e.name==n.name&&(e.compression=n.compression,n.index>=0&&(c.idx[n.index]=w),e.offset=w)}}let u,f,h;if(o.acCompressedSize>0)switch(o.acCompression){case 0:u=new Uint16Array(o.totalAcUncompressedCount),S(e.array,t,n,o.acCompressedSize,u,o.totalAcUncompressedCount);break;case 1:const r=N(e.array.slice(n.value,n.value+o.totalAcUncompressedCount));u=new Uint16Array(r.buffer),n.value+=o.totalAcUncompressedCount}if(o.dcCompressedSize>0){const t={array:e.array,offset:n,size:o.dcCompressedSize};f=new Uint16Array(H(t).buffer),n.value+=o.dcCompressedSize}if(o.rleRawSize>0){h=R(N(e.array.slice(n.value,n.value+o.rleCompressedSize)).buffer),n.value+=o.rleCompressedSize}let d=0;const p=new Array(l.length);for(let w=0;w<p.length;++w)p[w]=new Array;for(let w=0;w<e.lines;++w)for(let t=0;t<l.length;++t)p[t].push(d),d+=l[t].width*e.type*2;!function(e,t,n,r,o,a){let i=new DataView(a.buffer);const s=n[e.idx[0]].width,l=n[e.idx[0]].height,c=Math.floor(s/8),u=Math.ceil(s/8),f=Math.ceil(l/8),h=s-8*(u-1),d=l-8*(f-1),p={value:0},w=new Array(3),y=new Array(3),v=new Array(3),g=new Array(3),m=new Array(3);for(let E=0;E<3;++E)m[E]=t[e.idx[E]],w[E]=E<1?0:w[E-1]+u*f,y[E]=new Float32Array(64),v[E]=new Uint16Array(64),g[E]=new Uint16Array(64*u);for(let E=0;E<f;++E){let t=8;E==f-1&&(t=d);let a=8;for(let e=0;e<u;++e){e==u-1&&(a=h);for(let e=0;e<3;++e)v[e].fill(0),v[e][0]=o[w[e]++],C(p,r,v[e]),k(v[e],y[e]),x(y[e]);O(y);for(let t=0;t<3;++t)I(y[t],g[t],64*e)}let s=0;for(let r=0;r<3;++r){const o=n[e.idx[r]].type;for(let e=8*E;e<8*E+t;++e){s=m[r][e];for(let t=0;t<c;++t){const n=64*t+8*(7&e);i.setUint16(s+0*o,g[r][n+0],!0),i.setUint16(s+2*o,g[r][n+1],!0),i.setUint16(s+4*o,g[r][n+2],!0),i.setUint16(s+6*o,g[r][n+3],!0),i.setUint16(s+8*o,g[r][n+4],!0),i.setUint16(s+10*o,g[r][n+5],!0),i.setUint16(s+12*o,g[r][n+6],!0),i.setUint16(s+14*o,g[r][n+7],!0),s+=16*o}}if(c!=u)for(let e=8*E;e<8*E+t;++e){const t=m[r][e]+8*c*2*o,n=64*c+8*(7&e);for(let e=0;e<a;++e)i.setUint16(t+2*e*o,g[r][n+e],!0)}}}const b=new Uint16Array(s);i=new DataView(a.buffer);for(let E=0;E<3;++E){n[e.idx[E]].decoded=!0;const t=n[e.idx[E]].type;if(2==n[E].type)for(let e=0;e<l;++e){const n=m[E][e];for(let e=0;e<s;++e)b[e]=i.getUint16(n+2*e*t,!0);for(let e=0;e<s;++e)i.setFloat32(n+2*e*t,q(b[e]),!0)}}}(c,p,l,u,f,r);for(let w=0;w<l.length;++w){const t=l[w];if(!t.decoded){if(2!==t.compression)throw new Error("EXRLoader.parse: unsupported channel compression");{let n=0,o=0;for(let a=0;a<e.lines;++a){let e=p[w][n];for(let n=0;n<t.width;++n){for(let n=0;n<2*t.type;++n)r[e++]=h[o+n*t.width*t.height];o++}n++}}}}return new DataView(r.buffer)}function B(e,t){const n=new Uint8Array(e);let r=0;for(;0!=n[t.value+r];)r+=1;const o=(new TextDecoder).decode(n.slice(t.value,t.value+r));return t.value=t.value+r+1,o}function F(e,t){const n=e.getInt32(t.value,!0);return t.value=t.value+4,n}function G(e,t){const n=e.getUint32(t.value,!0);return t.value=t.value+4,n}function V(e,t){const n=e[t.value];return t.value=t.value+1,n}function W(e,t){const n=e.getUint8(t.value);return t.value=t.value+1,n}const X=function(e,t){let n;return n="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,n};function Y(e,t){const n=e.getFloat32(t.value,!0);return t.value+=4,n}function Z(e,t){return r.GxU.toHalfFloat(Y(e,t))}function q(e){const t=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(t?31===t?n?NaN:1/0:Math.pow(2,t-15)*(1+n/1024):n/1024*6103515625e-14)}function Q(e,t){const n=e.getUint16(t.value,!0);return t.value+=2,n}function $(e,t){return q(Q(e,t))}function j(e,t,n,r,o){return"string"===r||"stringvector"===r||"iccProfile"===r?function(e,t,n){const r=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+n));return t.value=t.value+n,r}(t,n,o):"chlist"===r?function(e,t,n,r){const o=n.value,a=[];for(;n.value<o+r-1;){const r=B(t,n),o=F(e,n),i=W(e,n);n.value+=3;const s=F(e,n),l=F(e,n);a.push({name:r,pixelType:o,pLinear:i,xSampling:s,ySampling:l})}return n.value+=1,a}(e,t,n,o):"chromaticities"===r?function(e,t){return{redX:Y(e,t),redY:Y(e,t),greenX:Y(e,t),greenY:Y(e,t),blueX:Y(e,t),blueY:Y(e,t),whiteX:Y(e,t),whiteY:Y(e,t)}}(e,n):"compression"===r?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][W(e,t)]}(e,n):"box2i"===r?function(e,t){return{xMin:F(e,t),yMin:F(e,t),xMax:F(e,t),yMax:F(e,t)}}(e,n):"envmap"===r?function(e,t){return["ENVMAP_LATLONG","ENVMAP_CUBE"][W(e,t)]}(e,n):"tiledesc"===r?function(e,t){const n=G(e,t),r=G(e,t),o=W(e,t);return{xSize:n,ySize:r,levelMode:["ONE_LEVEL","MIPMAP_LEVELS","RIPMAP_LEVELS"][15&o],roundingMode:["ROUND_DOWN","ROUND_UP"][o>>4]}}(e,n):"lineOrder"===r?function(e,t){return["INCREASING_Y","DECREASING_Y","RANDOM_Y"][W(e,t)]}(e,n):"float"===r?Y(e,n):"v2f"===r?function(e,t){return[Y(e,t),Y(e,t)]}(e,n):"v3f"===r?function(e,t){return[Y(e,t),Y(e,t),Y(e,t)]}(e,n):"int"===r?F(e,n):"rational"===r?function(e,t){return[F(e,t),G(e,t)]}(e,n):"timecode"===r?function(e,t){return[G(e,t),G(e,t)]}(e,n):"preview"===r?(n.value+=o,"skipped"):void(n.value+=o)}function J(e,t,n){let r=0;switch(e.levelMode){case"ONE_LEVEL":r=1;break;case"MIPMAP_LEVELS":r=function(e,t){const n=Math.log2(e);return"ROUND_DOWN"==t?Math.floor(n):Math.ceil(n)}(Math.max(t,n),e.roundingMode)+1;break;case"RIPMAP_LEVELS":throw new Error("THREE.EXRLoader: RIPMAP_LEVELS tiles currently unsupported.")}return r}function K(e,t,n,r){const o=new Array(e);for(let a=0;a<e;a++){const e=1<<a;let i=t/e|0;"ROUND_UP"==r&&i*e<t&&(i+=1);const s=Math.max(i,1);o[a]=(s+n-1)/n|0}return o}function ee(){const e=this,t=e.offset,n={value:0};for(let r=0;r<e.tileCount;r++){const r=F(e.viewer,t),o=F(e.viewer,t);t.value+=8,e.size=G(e.viewer,t);const a=r*e.blockWidth,i=o*e.blockHeight;e.columns=a+e.blockWidth>e.width?e.width-a:e.blockWidth,e.lines=i+e.blockHeight>e.height?e.height-i:e.blockHeight;const s=e.columns*e.totalBytes,l=e.size<e.lines*s?e.uncompress(e):L(e);t.value+=e.size;for(let t=0;t<e.lines;t++){const r=t*e.columns*e.totalBytes;for(let o=0;o<e.inputChannels.length;o++){const s=ae.channels[o].name,c=e.channelByteOffsets[s]*e.columns,u=e.decodeChannels[s];if(void 0===u)continue;n.value=r+c;const f=(e.height-(1+i+t))*e.outLineWidth;for(let t=0;t<e.columns;t++){const r=f+(t+a)*e.outputChannels+u;e.byteArray[r]=e.getter(l,n)}}}}}function te(){const e=this,t=e.offset,n={value:0};for(let r=0;r<e.height/e.blockHeight;r++){const o=F(e.viewer,t)-ae.dataWindow.yMin;e.size=G(e.viewer,t),e.lines=o+e.blockHeight>e.height?e.height-o:e.blockHeight;const a=e.columns*e.totalBytes,i=e.size<e.lines*a?e.uncompress(e):L(e);t.value+=e.size;for(let t=0;t<e.blockHeight;t++){const o=r*e.blockHeight,s=t+e.scanOrder(o);if(s>=e.height)continue;const l=t*a,c=(e.height-1-s)*e.outLineWidth;for(let t=0;t<e.inputChannels.length;t++){const r=ae.channels[t].name,o=e.channelByteOffsets[r]*e.columns,a=e.decodeChannels[r];if(void 0!==a){n.value=l+o;for(let t=0;t<e.columns;t++){const r=c+t*e.outputChannels+a;e.byteArray[r]=e.getter(i,n)}}}}}}const ne={value:0},re=new DataView(e),oe=new Uint8Array(e),ae=function(e,t,n){const r={};if(20000630!=e.getUint32(0,!0))throw new Error("THREE.EXRLoader: Provided file doesn't appear to be in OpenEXR format.");r.version=e.getUint8(4);const o=e.getUint8(5);r.spec={singleTile:!!(2&o),longName:!!(4&o),deepFormat:!!(8&o),multiPart:!!(16&o)},n.value=8;let a=!0;for(;a;){const o=B(t,n);if(0==o)a=!1;else{const a=B(t,n),i=j(e,t,n,a,G(e,n));void 0===i?console.warn("THREE.EXRLoader: Skipped unknown header attribute type '".concat(a,"'.")):r[o]=i}}if(0!=(-7&o))throw console.error("THREE.EXRHeader:",r),new Error("THREE.EXRLoader: Provided file is currently unsupported.");return r}(re,e,ne),ie=function(e,t,n,o,a){const i={size:0,viewer:t,array:n,offset:o,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,inputChannels:e.channels,channelByteOffsets:{},scanOrder:null,totalBytes:null,columns:null,lines:null,type:null,uncompress:null,getter:null,format:null,colorSpace:r.Zr2};switch(e.compression){case"NO_COMPRESSION":i.blockHeight=1,i.uncompress=L;break;case"RLE_COMPRESSION":i.blockHeight=1,i.uncompress=z;break;case"ZIPS_COMPRESSION":i.blockHeight=1,i.uncompress=H;break;case"ZIP_COMPRESSION":i.blockHeight=16,i.uncompress=H;break;case"PIZ_COMPRESSION":i.blockHeight=32,i.uncompress=_;break;case"PXR24_COMPRESSION":i.blockHeight=16,i.uncompress=T;break;case"DWAA_COMPRESSION":i.blockHeight=32,i.uncompress=D;break;case"DWAB_COMPRESSION":i.blockHeight=256,i.uncompress=D;break;default:throw new Error("EXRLoader.parse: "+e.compression+" is unsupported")}const s={};for(const r of e.channels)switch(r.name){case"Y":case"R":case"G":case"B":case"A":s[r.name]=!0,i.type=r.pixelType}let l=!1;if(s.R&&s.G&&s.B)l=!s.A,i.outputChannels=4,i.decodeChannels={R:0,G:1,B:2,A:3};else{if(!s.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");i.outputChannels=1,i.decodeChannels={Y:0}}if(1==i.type)switch(a){case r.RQf:i.getter=$;break;case r.ix0:i.getter=Q}else{if(2!=i.type)throw new Error("EXRLoader.parse: unsupported pixelType "+i.type+" for "+e.compression+".");switch(a){case r.RQf:i.getter=Y;break;case r.ix0:i.getter=Z}}i.columns=i.width;const c=i.width*i.height*i.outputChannels;switch(a){case r.RQf:i.byteArray=new Float32Array(c),l&&i.byteArray.fill(1,0,c);break;case r.ix0:i.byteArray=new Uint16Array(c),l&&i.byteArray.fill(15360,0,c);break;default:console.error("THREE.EXRLoader: unsupported type: ",a)}let u=0;for(const r of e.channels)void 0!==i.decodeChannels[r.name]&&(i.channelByteOffsets[r.name]=u),u+=2*r.pixelType;if(i.totalBytes=u,i.outLineWidth=i.width*i.outputChannels,"INCREASING_Y"===e.lineOrder?i.scanOrder=e=>e:i.scanOrder=e=>i.height-1-e,4==i.outputChannels?(i.format=r.GWd,i.colorSpace=r.Zr2):(i.format=r.VT0,i.colorSpace=r.jf0),e.spec.singleTile){i.blockHeight=e.tiles.ySize,i.blockWidth=e.tiles.xSize;const n=J(e.tiles,i.width,i.height),r=K(n,i.width,e.tiles.xSize,e.tiles.roundingMode),a=K(n,i.height,e.tiles.ySize,e.tiles.roundingMode);i.tileCount=r[0]*a[0];for(let e=0;e<n;e++)for(let n=0;n<a[e];n++)for(let a=0;a<r[e];a++)X(t,o);i.decode=ee.bind(i)}else{i.blockWidth=i.width;const e=Math.ceil(i.height/i.blockHeight);for(let n=0;n<e;n++)X(t,o);i.decode=te.bind(i)}return i}(ae,re,oe,ne,this.type);return ie.decode(),{header:ae,width:ie.width,height:ie.height,data:ie.byteArray,format:ie.format,colorSpace:ie.colorSpace,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,o){return super.load(e,(function(e,n){e.colorSpace=n.colorSpace,e.minFilter=r.k6q,e.magFilter=r.k6q,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,n)}),n,o)}}},6064:(e,t,n)=>{n.d(t,{Y:()=>o});var r=n(9435);class o extends r.BRH{constructor(e){super(e),this.type=r.ix0}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,o=-1,a=0,i="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(o=s.indexOf("\n"))&&a<t&&r<e.byteLength;)i+=s,a+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<o&&(!1!==n&&(e.pos+=a+o+1),i+s.slice(0,o))},o=function(e,t,n,r){const o=e[t+3],a=Math.pow(2,o-128)/255;n[r+0]=e[t+0]*a,n[r+1]=e[t+1]*a,n[r+2]=e[t+2]*a,n[r+3]=1},a=function(e,t,n,o){const a=e[t+3],i=Math.pow(2,a-128)/255;n[o+0]=r.GxU.toHalfFloat(Math.min(e[t+0]*i,65504)),n[o+1]=r.GxU.toHalfFloat(Math.min(e[t+1]*i,65504)),n[o+2]=r.GxU.toHalfFloat(Math.min(e[t+2]*i,65504)),n[o+3]=r.GxU.toHalfFloat(1)},i=new Uint8Array(e);i.pos=0;const s=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,i=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=n(e)))&&t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),s.valid|=1,s.programtype=c[1],s.string+=l+"\n";l=n(e),!1!==l;)if(s.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(r))&&(s.gamma=parseFloat(c[1])),(c=l.match(o))&&(s.exposure=parseFloat(c[1])),(c=l.match(a))&&(s.valid|=2,s.format=c[1]),(c=l.match(i))&&(s.valid|=4,s.height=parseInt(c[1],10),s.width=parseInt(c[2],10)),2&s.valid&&4&s.valid)break}else s.comments+=l+"\n";return 2&s.valid||t(3,"missing format specifier"),4&s.valid||t(3,"missing image size specifier"),s}(i),l=s.width,c=s.height,u=function(e,n,r){const o=n;if(o<8||o>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);o!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const a=new Uint8Array(4*n*r);a.length||t(4,"unable to allocate buffer space");let i=0,s=0;const l=4*o,c=new Uint8Array(4),u=new Uint8Array(l);let f=r;for(;f>0&&s<e.byteLength;){s+4>e.byteLength&&t(1),c[0]=e[s++],c[1]=e[s++],c[2]=e[s++],c[3]=e[s++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==o||t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&s<e.byteLength;){n=e[s++];const o=n>128;if(o&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),o){const t=e[s++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(s,s+n),r),r+=n,s+=n}const h=o;for(let e=0;e<h;e++){let t=0;a[i]=u[e+t],t+=o,a[i+1]=u[e+t],t+=o,a[i+2]=u[e+t],t+=o,a[i+3]=u[e+t],i+=4}f--}return a}(i.subarray(i.pos),l,c);let f,h,d;switch(this.type){case r.RQf:d=u.length/4;const e=new Float32Array(4*d);for(let n=0;n<d;n++)o(u,4*n,e,4*n);f=e,h=r.RQf;break;case r.ix0:d=u.length/4;const t=new Uint16Array(4*d);for(let n=0;n<d;n++)a(u,4*n,t,4*n);f=t,h=r.ix0;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:f,header:s.string,gamma:s.gamma,exposure:s.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,n,o){return super.load(e,(function(e,n){switch(e.type){case r.RQf:case r.ix0:e.colorSpace=r.Zr2,e.minFilter=r.k6q,e.magFilter=r.k6q,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,o)}}}}]);
//# sourceMappingURL=232.9d8b5e5b.chunk.js.map