"use strict";(self.webpackChunkreact_3d=self.webpackChunkreact_3d||[]).push([[433],{1433:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var o=r(5043),s=r(9435),n=r(9408),i=r(4718);const a=new WeakMap;class d extends s.aHM{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,o){const n=new s.Y9S(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,(e=>{this.parse(e,t,o)}),r,o)}parse(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};this.decodeDracoFile(e,t,null,null,s.er$,r).catch(r)}decodeDracoFile(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.Zr2,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>{};const a={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:n};return this.decodeGeometry(e,a).then(t).catch(i)}decodeGeometry(e,t){const r=JSON.stringify(t);if(a.has(e)){const t=a.get(e);if(t.key===r)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const s=this.workerNextTaskID++,n=e.byteLength,i=this._getWorker(s,n).then((r=>(o=r,new Promise(((r,n)=>{o._callbacks[s]={resolve:r,reject:n},o.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return i.catch((()=>!0)).then((()=>{o&&s&&this._releaseTask(o,s)})),a.set(e,{key:r,promise:i}),i}_createGeometry(e){const t=new s.LoY;e.index&&t.setIndex(new s.THS(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const o=e.attributes[r],n=o.name,i=o.array,a=o.itemSize,d=new s.THS(i,a);"color"===n&&(this._assignVertexColorSpace(d,o.vertexColorSpace),d.normalized=i instanceof Float32Array===!1),t.setAttribute(n,d)}return t}_assignVertexColorSpace(e,t){if(t!==s.er$)return;const r=new s.Q1f;for(let o=0,n=e.count;o<n;o++)r.fromBufferAttribute(e,o),s.ppV.toWorkingColorSpace(r,s.er$),e.setXYZ(o,r.r,r.g,r.b)}_loadLibrary(e,t){const r=new s.Y9S(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise(((t,o)=>{r.load(e,t,void 0,o)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const o=c.toString(),s=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function c(){let e,t;function r(e,t,r,o,s,n){const i=n.num_components(),a=r.num_points()*i,d=a*s.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),h=e._malloc(d);t.GetAttributeDataArrayForAllPoints(r,n,c,d,h);const l=new s(e.HEAPF32.buffer,h,a).slice();return e._free(h),{name:o,array:l,itemSize:i}}onmessage=function(o){const s=o.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const o=s.buffer,n=s.taskConfig;t.then((e=>{const t=e.draco,i=new t.Decoder;try{const e=function(e,t,o,s){const n=s.attributeIDs,i=s.attributeTypes;let a,d;const c=t.GetEncodedGeometryType(o);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,d=t.DecodeArrayToMesh(o,o.byteLength,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,d=t.DecodeArrayToPointCloud(o,o.byteLength,a)}if(!d.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const h={index:null,attributes:[]};for(const l in n){const o=self[i[l]];let d,c;if(s.useUniqueIDs)c=n[l],d=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[n[l]]),-1===c)continue;d=t.GetAttribute(a,c)}const u=r(e,t,a,l,o,d);"color"===l&&(u.vertexColorSpace=s.vertexColorSpace),h.attributes.push(u)}c===e.TRIANGULAR_MESH&&(h.index=function(e,t,r){const o=r.num_faces(),s=3*o,n=4*s,i=e._malloc(n);t.GetTrianglesUInt32Array(r,n,i);const a=new Uint32Array(e.HEAPF32.buffer,i,s).slice();return e._free(i),{array:a,itemSize:1}}(e,t,a));return e.destroy(a),h}(t,i,new Int8Array(o),n),a=e.attributes.map((e=>e.array.buffer));e.index&&a.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},a)}catch(a){console.error(a),self.postMessage({type:"error",id:s.id,error:a.message})}finally{t.destroy(i)}}))}}}var h=r(7583),l=r(579);class u extends o.Component{constructor(){super(...arguments),this.initThree=()=>{const e=document.querySelector("canvas.webgl"),t=new s.Z58,r=new d;r.setDecoderPath("./draco/");const o=new i.B;o.setDRACOLoader(r);let a=null;o.load("./models/Fox/glTF/Fox.gltf",(e=>{e.scene.scale.set(.025,.025,.025),t.add(e.scene),a=new s.Iw4(e.scene);a.clipAction(e.animations[1]).play()}));const c=new s.eaF(new s.bdM(10,10),new s._4j({color:"#444444",metalness:0,roughness:.5}));c.receiveShadow=!0,c.rotation.x=.5*-Math.PI,t.add(c);const l=new s.$p8(16777215,.8);t.add(l);const u=new s.ZyN(16777215,.6);u.castShadow=!0,u.shadow.mapSize.set(1024,1024),u.shadow.camera.far=15,u.shadow.camera.left=-7,u.shadow.camera.top=7,u.shadow.camera.right=7,u.shadow.camera.bottom=-7,u.position.set(5,5,5),t.add(u);const w={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",(()=>{w.width=window.innerWidth,w.height=window.innerHeight,f.aspect=w.width/w.height,f.updateProjectionMatrix(),y.setSize(w.width,w.height),y.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const f=new s.ubm(75,w.width/w.height,.1,100);f.position.set(2,2,2),t.add(f);const p=new h.N(f,e);p.target.set(0,.75,0),p.enableDamping=!0;const y=new n.JeP({canvas:e});y.shadowMap.enabled=!0,y.shadowMap.type=s.Wk7,y.setSize(w.width,w.height),y.setPixelRatio(Math.min(window.devicePixelRatio,2));const g=new s.zD7;let m=0;const b=()=>{const e=g.getElapsedTime(),r=e-m;m=e,a&&a.update(r),y.render(t,f),p.update(),window.requestAnimationFrame(b)};b()}}componentDidMount(){this.initThree()}render(){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("canvas",{className:"webgl"})})}}}}]);
//# sourceMappingURL=433.e8dc55a2.chunk.js.map